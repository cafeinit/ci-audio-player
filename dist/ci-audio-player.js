!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.CIAudioPlayer=n():t.CIAudioPlayer=n()}(window,function(){return function(t){var n={};function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n);var i=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();var r=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.onPlay=null,this.onPlaying=null,this.onEnded=null,this.onError=null}return i(t,[{key:"getPlayer",value:function(){return this.player||(this.player=new Audio),this.player}},{key:"play",value:function(t){var n=this,e=this.getPlayer();e.onplay=function(t){"function"==typeof n.onPlay&&n.onPlay(t,e.currentTime||0,e.duration||0)},e.ontimeupdate=function(t){"function"==typeof n.onPlaying&&n.onPlaying(t,e.currentTime||0,e.duration||0)},e.onended=function(t){"function"==typeof n.onEnded&&n.onEnded(t)},e.onerror=function(t){"function"==typeof n.onError&&n.onError(t)},t.src&&t.src!==e.currentSrc&&(e.src=t.src),console.log("CIAudioPlayerCore.play"),e.play()}},{key:"pause",value:function(){this.getPlayer().pause()}},{key:"goto",value:function(t){var n=this.getPlayer();n.currentTime=n.duration*t||0}}]),t}(),o=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();var s=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.playList=null,this.tracks=[],this.index=0,this.mode=2,this.isLoop=!0,this.isPlaying=!1,this.currentTime=0,this.duration=0,this.progress=0,this.player=new r,this.onPause=null,this.onTrackPlay=null,this.onTrackPlaying=null,this.onListEnd=null}return o(t,[{key:"setPlayList",value:function(t){this.playList=t,this.initTracks()}},{key:"setMode",value:function(t){this.mode=t,this.initTracks()}},{key:"setLoop",value:function(t){this.isLoop=t}},{key:"play",value:function(t){var n=this;"number"==typeof t?(this.index=parseInt(t)||0,this.playList.setCurrentIndex(t)):this.playList.setCurrentIndex(this.index),1===this.mode&&(this.index=0,this.initTracks());var e=this.getTrack(this.index);if(e){var i=this.player;i.onPlay=function(t,i,r){n.isPlaying=!0,n.currentTime=i,n.duration=r,n.progress=0,"function"==typeof n.onTrackPlay&&n.onTrackPlay(n.index,e)},i.onPlaying=function(t,i,r){if("function"==typeof n.onTrackPlaying){var o=0;r>0&&(o=(o=i/r)>1?1:o),n.currentTime=i,n.duration=r,n.progress=o,n.onTrackPlaying(n.index,e,{currentTime:i,duration:r,progress:o})}},i.onEnded=function(t){n.playNext()},i.onError=function(t){"function"==typeof n.onError&&n.onError(n.index,t)},i.play(e)}else"function"==typeof this.onError&&this.onError("Track "+t+" undefinded")}},{key:"playPrev",value:function(){var t=this.index-1;t<0?this.isLoop?(t=this.tracks.length-1,this.index=t,this.play()):this.stop():(this.index=t,this.play())}},{key:"playNext",value:function(){var t=this.index+1;t>=this.tracks.length?this.isLoop?(t=0,this.index=t,this.play()):this.stop():(this.index=t,this.play())}},{key:"pause",value:function(){this.player.pause(),this.isPlaying=!1,"function"==typeof this.onPause&&this.onPause(this.index)}},{key:"stop",value:function(){this.isPlaying=!1,"function"==typeof this.onListEnd&&this.onListEnd(this.index)}},{key:"gotoAndPlay",value:function(t){this.player.goto(t)}},{key:"initTracks",value:function(t){1===this.mode?this.tracks=[this.playList.getCurrentItem()]:2===this.mode?this.tracks=this.playList.getItems():3===this.mode&&(this.tracks=this.playList.getItems(!0))}},{key:"getTrack",value:function(t){return this.tracks[t]||null}}]),t}(),u=function(){function t(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,e,i){return e&&t(n.prototype,e),i&&t(n,i),n}}();function a(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}var l=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.index=0,this.list=[]}return u(t,[{key:"getItem",value:function(t){return this.list[t]||null}},{key:"getLastItem",value:function(){return this.list[this.list.length-1]||null}},{key:"getCurrentItem",value:function(){return this.getItem(this.index)}},{key:"getItems",value:function(t){return[].concat(a(this.list))}},{key:"setItem",value:function(t,n){return t=(t=t<0?0:t)>this.list.length?this.list.length:t,n.index=t,this.list[t]=n,n}},{key:"setCurrentIndex",value:function(t){this.index=t,this.list.forEach(function(n,e){n.is_actived=e===t})}},{key:"addItem",value:function(t){return t.index=this.list.length||0,this.list.push(t),t}},{key:"removeItem",value:function(t){this.list.splice(t,1)}}]),t}();e.d(n,"CIAudioPlayer",function(){return s}),e.d(n,"CIAudioPlayerCore",function(){return r}),e.d(n,"CIPlayList",function(){return l})}])});